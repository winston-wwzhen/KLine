<!--pages/admin/sync/sync.wxml-->
<view class="container">
  <view class="header">
    <text class="title">æ•°æ®åŒæ­¥ç®¡ç†</text>
  </view>

  <!-- è¿›åº¦å¡ç‰‡ -->
  <view class="card">
    <view class="card-title">åŒæ­¥è¿›åº¦</view>
    <view class="progress-info">
      <text class="progress-text">{{progress}}%</text>
      <text class="progress-detail">({{stats.syncedCities}}/{{stats.totalCities}} åŸå¸‚)</text>
    </view>
    <view class="progress-bar">
      <view class="progress-fill" style="width: {{progress}}%"></view>
    </view>
    <view class="stats">
      <view class="stat-item">
        <text class="stat-value">{{stats.syncedCities}}</text>
        <text class="stat-label">æˆåŠŸ</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{stats.failedCities}}</text>
        <text class="stat-label">å¤±è´¥</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{currentBatch}}/{{totalBatches}}</text>
        <text class="stat-label">æ‰¹æ¬¡</text>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="actions">
    <button
      wx:if="{{!syncing}}"
      class="btn btn-primary"
      bindtap="startSync"
    >
      å¼€å§‹åŒæ­¥
    </button>
    <button
      wx:else
      class="btn btn-danger"
      bindtap="stopSync"
    >
      åœæ­¢åŒæ­¥
    </button>
    <button
      class="btn btn-secondary"
      bindtap="clearLogs"
      disabled="{{syncing}}"
    >
      æ¸…ç©ºæ—¥å¿—
    </button>
  </view>

  <!-- åŒæ­¥æ—¥å¿— -->
  <view class="card log-card">
    <view class="card-title">
      åŒæ­¥æ—¥å¿—
      <text class="log-count">({{logs.length}})</text>
    </view>
    <scroll-view id="log-container" class="log-container" scroll-y scroll-into-view="log-bottom">
      <view class="log-list">
        <block wx:if="{{logs.length > 0}}">
          <view class="log-item" wx:for="{{logs}}" wx:key="index">
            <text>{{item}}</text>
          </view>
        </block>
        <view wx:else class="log-empty">
          <text>æš‚æ— æ—¥å¿—</text>
        </view>
        <view id="log-bottom"></view>
      </view>
    </scroll-view>
  </view>

  <!-- è¯´æ˜ -->
  <view class="tips">
    <text class="tips-title">ğŸ’¡ è¯´æ˜</text>
    <text class="tips-text">â€¢ æ¯æ‰¹åŒæ­¥3ä¸ªåŸå¸‚ï¼Œå…±11æ‰¹</text>
    <text class="tips-text">â€¢ æ¯æ‰¹çº¦éœ€50-60ç§’</text>
    <text class="tips-text">â€¢ æ€»è®¡çº¦10åˆ†é’Ÿå®Œæˆ</text>
    <text class="tips-text">â€¢ å¯éšæ—¶åœæ­¢ï¼Œä¸‹æ¬¡å¯ç»§ç»­</text>
  </view>
</view>
